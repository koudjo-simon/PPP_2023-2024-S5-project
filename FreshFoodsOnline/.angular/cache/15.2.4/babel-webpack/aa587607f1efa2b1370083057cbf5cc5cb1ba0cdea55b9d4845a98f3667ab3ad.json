{"ast":null,"code":"import { of, throwError } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"./cart.service\";\nexport class CommandService {\n  constructor(http, cartService) {\n    this.http = http;\n    this.cartService = cartService;\n    this.commandList = [];\n    this.commandLineList = [];\n    this.commandPassed = false;\n    this.apiUrl = \"http://localhost:8080/api/\";\n    cartService.getCartCmdLinesFoods().subscribe({\n      next: value => {\n        this.commandLineList = value;\n        console.log(\"Getting command lines of the cart\");\n      }\n    });\n  }\n  addCommand(cmd) {\n    if (cmd == undefined) return throwError(() => new Error(\"Command add failed\"));\n    /*const cust: Customer = {\r\n      customerId: \"\",\r\n      firstname: cmd.customer.firstname,\r\n      age: cmd.customer.age,\r\n          }*/\n    this.http.post(this.apiUrl + \"customers/add\", cmd.customer).subscribe({\n      next: customer => {\n        console.log(\"My customerId: \" + customer.customerId);\n        this.http.get(this.apiUrl + \"commands/addFor/\" + customer.customerId).subscribe({\n          next: command => {\n            console.log(\"Affichage de la list des command Lines: \", this.commandLineList);\n            this.commandLineList.forEach(commandLine => {\n              this.http.get(this.apiUrl + \"commandLine/add?foodId=\" + \"commandLine.food.foodId\" + \"&&commandId=\" + command.commandId + \"&&quantity=\" + commandLine.quantity).subscribe({\n                next: cmdLine => {\n                  console.log(\"The command passed successfully\");\n                },\n                error: err => throwError(() => new Error(err))\n              });\n            });\n          }\n        });\n      },\n      error: err => throwError(() => new Error(err))\n    });\n    return of(cmd);\n  }\n  setCommandLines(cmdLines) {\n    if (cmdLines.length > 0) {\n      cmdLines.forEach(cmdLine => {\n        this.commandLineList.push(cmdLine);\n      });\n    }\n  }\n  getCommands() {\n    if (this.commandList.length == 0) return throwError(() => new Error(\"Command List is empty\"));\n    return of(this.commandList);\n  }\n  getCommandLines() {\n    if (this.commandLineList.length == 0) return throwError(() => new Error(\"Command Line list is empty.\"));\n    return of(this.commandLineList);\n  }\n  setCommandPassed() {\n    this.commandPassed = true;\n  }\n  isCommandPassed() {\n    return this.commandPassed;\n  }\n}\nCommandService.ɵfac = function CommandService_Factory(t) {\n  return new (t || CommandService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.CartService));\n};\nCommandService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: CommandService,\n  factory: CommandService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"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","names":["of","throwError","CommandService","constructor","http","cartService","getCartCmdLinesFoods","subscribe","next","value","commandLineList","console","log","addCommand","cmd","undefined","Error","post","apiUrl","customer","customerId","get","command","forEach","commandLine","commandId","quantity","cmdLine","error","err","setCommandLines","cmdLines","length","push","getCommands","commandList","getCommandLines","setCommandPassed","commandPassed","isCommandPassed","factory","providedIn"],"sourceRoot":"","sources":["D:\\ESIG GLOBAL SUCCESS - PARCOURS\\ESIG LICENCE 2 - Génie Logiciel\\ESIG Licence 2 - SEMESTRE 4\\Licence 2 - Complement Web\\TRAVAIL DE M. AGBO - COMPLEMENT DEVELOPPEMENT\\MyWork\\FreshFoodsOnline\\src\\app\\services\\command.service.ts"],"sourcesContent":["import {Injectable} from '@angular/core';\nimport {Command} from '../shared/model/command';\nimport {CommandLine} from '../shared/model/command-line';\nimport {Observable, of, throwError} from 'rxjs';\nimport {HttpClient} from \"@angular/common/http\";\nimport {Customer} from \"../shared/model/customer\";\nimport {CartService} from \"./cart.service\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CommandService {\n\n  private commandList: Command[] = [];\n  private commandLineList: CommandLine[] = [];\n  public commandPassed: boolean = false;\n\n  apiUrl = \"http://localhost:8080/api/\"\n\n  constructor(private http: HttpClient, private cartService: CartService) {\n    cartService.getCartCmdLinesFoods().subscribe({\n      next: value => {\n        this.commandLineList = value;\n        console.log(\"Getting command lines of the cart\");\n      }\n    })\n  }\n\n  public addCommand(cmd: Command): Observable<Command> {\n    if (cmd == undefined) return throwError(() => new Error(\"Command add failed\"));\n    /*const cust: Customer = {\n      customerId: \"\",\n      firstname: cmd.customer.firstname,\n      age: cmd.customer.age,\n\n    }*/\n    this.http.post<Customer>(this.apiUrl + \"customers/add\", cmd.customer).subscribe({\n      next: customer => {\n        console.log(\"My customerId: \" + customer.customerId)\n        this.http.get<Command>(this.apiUrl + \"commands/addFor/\" + customer.customerId)\n          .subscribe({\n          next: command => {\n            console.log(\"Affichage de la list des command Lines: \", this.commandLineList)\n            this.commandLineList.forEach(commandLine => {\n              this.http.get<CommandLine>(this.apiUrl + \"commandLine/add?foodId=\"\n                + \"commandLine.food.foodId\" + \"&&commandId=\" + command.commandId +\n                \"&&quantity=\" + commandLine.quantity).subscribe({\n                next: cmdLine => {\n                  console.log(\"The command passed successfully\");\n                },\n                error: err => throwError(() => new Error(err))\n              })\n            })\n          }\n        });\n      },\n      error: err => throwError(() => new Error(err))\n    });\n    return of(cmd)\n  }\n\n  public setCommandLines(cmdLines: CommandLine[]) {\n    if (cmdLines.length > 0) {\n      cmdLines.forEach(cmdLine => {\n        this.commandLineList.push(cmdLine);\n      })\n    }\n  }\n\n  public getCommands(): Observable<Command[]> {\n    if (this.commandList.length == 0)\n      return throwError(() => new Error(\"Command List is empty\"));\n    return of(this.commandList);\n  }\n\n  public getCommandLines(): Observable<CommandLine[]> {\n    if (this.commandLineList.length == 0)\n      return throwError(() => new Error(\"Command Line list is empty.\"));\n    return of(this.commandLineList);\n  }\n\n  private setCommandPassed() {\n    this.commandPassed = true;\n  }\n\n  public isCommandPassed(): boolean {\n    return this.commandPassed\n  }\n\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}