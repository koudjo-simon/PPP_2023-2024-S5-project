{"ast":null,"code":"import { of, throwError } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport class CartService {\n  constructor() {\n    this.cardFoodsList = [];\n    this.cardCommandLinesList = [];\n  }\n  addToCart(prod) {\n    this.cardFoodsList.push(prod);\n    /*this.cardFoodsList.forEach(f => {\r\n      this.cardCommandLinesList.forEach(c => {\r\n        const existingCommandLine = this.cardCommandLinesList\r\n          .findIndex(commandLine => commandLine.food.foodId == food.foodId);\r\n        if (existingCommandLine) {\r\n          this.cardCommandLinesList[existingCommandLine].quantity++;\r\n          this.cardCommandLinesList[existingCommandLine].totalCommandLinePrice += food.price;\r\n        } else {\r\n          let commandLine: CommandLine = {\r\n            commandLineId: \"\",\r\n            food: f,\r\n            commandId: \"\",\r\n            unitPrice: f.price,\r\n            quantity: 1,\r\n            totalCommandLinePrice: f.price\r\n          };\r\n          this.cardCommandLinesList.push(commandLine);\r\n        }\r\n      });\r\n      })*/\n    // Recherche d'une ligne de commande comportant deja cette Food\n    const existingCommandLineIndex = this.cardCommandLinesList.findIndex(cmdLine => cmdLine.product.productId === prod.productId);\n    if (existingCommandLineIndex != -1) {\n      this.cardCommandLinesList[existingCommandLineIndex].quantity++;\n      this.cardCommandLinesList[existingCommandLineIndex].totalCommandLinePrice += prod.price;\n    } else {\n      let commandLine = {\n        commandLineId: \"\",\n        product: prod,\n        commandId: \"\",\n        unitPrice: prod.price,\n        quantity: 1,\n        totalCommandLinePrice: prod.price\n      };\n      this.cardCommandLinesList.push(commandLine);\n    }\n  }\n  addCommandLinesToTheCart(cmdLines) {\n    cmdLines.forEach(cmdLine => {\n      this.cardCommandLinesList.push(cmdLine);\n    });\n    return of(true);\n  }\n  getCartCmdLinesFoods() {\n    if (this.cardFoodsList.length > 0) {\n      return of(this.cardCommandLinesList);\n    } else {\n      return throwError(() => new Error(\"Food untifined in the cart list.\"));\n    }\n  }\n  getTotalPrice() {\n    let price = 0;\n    this.cardCommandLinesList.forEach(cmdLine => {\n      price += cmdLine.totalCommandLinePrice;\n    });\n    return of(price);\n  }\n  deleteComandeLine(commandLineId) {\n    this.cardCommandLinesList = this.cardCommandLinesList.filter(c => c.commandLineId == commandLineId);\n    return of(true);\n  }\n  deleteFoodById(id) {\n    this.cardFoodsList = this.cardFoodsList.filter(prod => prod.productId == id);\n    return of(true);\n  }\n  cardContainAddFoods() {\n    return this.cardFoodsList.length > 0;\n  }\n}\nCartService.ɵfac = function CartService_Factory(t) {\n  return new (t || CartService)();\n};\nCartService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: CartService,\n  factory: CartService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"AACA,SAAoBA,EAAE,EAAEC,UAAU,QAAO,MAAM;;AAQ/C,OAAM,MAAOC,WAAW;EAKtBC;IAHQ,kBAAa,GAAc,EAAE;IAC7B,yBAAoB,GAAkB,EAAE;EAEhC;EAETC,SAAS,CAACC,IAAU;IACzB,IAAI,CAACC,aAAa,CAACC,IAAI,CAACF,IAAI,CAAC;IAC7B;;;;;;;;;;;;;;;;;;;;IAoBA;IACA,MAAMG,wBAAwB,GAAG,IAAI,CAACC,oBAAoB,CACvDC,SAAS,CAACC,OAAO,IAAIA,OAAO,CAACC,OAAO,CAACC,SAAS,KAAKR,IAAI,CAACQ,SAAS,CAAC;IACrE,IAAIL,wBAAwB,IAAI,CAAC,CAAC,EAAC;MACjC,IAAI,CAACC,oBAAoB,CAACD,wBAAwB,CAAC,CAACM,QAAQ,EAAE;MAC9D,IAAI,CAACL,oBAAoB,CAACD,wBAAwB,CAAC,CAACO,qBAAqB,IAAIV,IAAI,CAACW,KAAK;KACxF,MAAK;MACJ,IAAIC,WAAW,GAAgB;QAC7BC,aAAa,EAAE,EAAE;QACjBN,OAAO,EAAEP,IAAI;QACbc,SAAS,EAAE,EAAE;QACbC,SAAS,EAAEf,IAAI,CAACW,KAAK;QACrBF,QAAQ,EAAE,CAAC;QACXC,qBAAqB,EAAEV,IAAI,CAACW;OAC7B;MACD,IAAI,CAACP,oBAAoB,CAACF,IAAI,CAACU,WAAW,CAAC;;EAE/C;EAEOI,wBAAwB,CAACC,QAA4B;IAC1DA,QAAQ,CAACC,OAAO,CAACZ,OAAO,IAAG;MACzB,IAAI,CAACF,oBAAoB,CAACF,IAAI,CAACI,OAAO,CAAC;IACzC,CAAC,CAAC;IACF,OAAOX,EAAE,CAAC,IAAI,CAAC;EACjB;EAEOwB,oBAAoB;IACzB,IAAI,IAAI,CAAClB,aAAa,CAACmB,MAAM,GAAG,CAAC,EAAE;MACjC,OAAOzB,EAAE,CAAC,IAAI,CAACS,oBAAoB,CAAC;KACrC,MAAM;MACL,OAAOR,UAAU,CAAC,MAAM,IAAIyB,KAAK,CAAC,kCAAkC,CAAC,CAAC;;EAE1E;EAEOC,aAAa;IAClB,IAAIX,KAAK,GAAW,CAAC;IACrB,IAAI,CAACP,oBAAoB,CAACc,OAAO,CAACZ,OAAO,IAAG;MAC1CK,KAAK,IAAIL,OAAO,CAACI,qBAAqB;IACxC,CAAC,CAAC;IACF,OAAOf,EAAE,CAACgB,KAAK,CAAC;EAClB;EAEOY,iBAAiB,CAACV,aAAqB;IAC5C,IAAI,CAACT,oBAAoB,GAAG,IAAI,CAACA,oBAAoB,CAACoB,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACZ,aAAa,IAAIA,aAAa,CAAC;IACnG,OAAOlB,EAAE,CAAC,IAAI,CAAC;EACjB;EAEO+B,cAAc,CAACC,EAAU;IAC9B,IAAI,CAAC1B,aAAa,GAAG,IAAI,CAACA,aAAa,CAACuB,MAAM,CAACxB,IAAI,IAAIA,IAAI,CAACQ,SAAS,IAAImB,EAAE,CAAC;IAC5E,OAAOhC,EAAE,CAAC,IAAI,CAAC;EACjB;EAEOiC,mBAAmB;IACxB,OAAO,IAAI,CAAC3B,aAAa,CAACmB,MAAM,GAAG,CAAC;EACtC;;AAnFWvB,WAAW;mBAAXA,WAAW;AAAA;AAAXA,WAAW;SAAXA,WAAW;EAAAgC,SAAXhC,WAAW;EAAAiC,YAFV;AAAM","names":["of","throwError","CartService","constructor","addToCart","prod","cardFoodsList","push","existingCommandLineIndex","cardCommandLinesList","findIndex","cmdLine","product","productId","quantity","totalCommandLinePrice","price","commandLine","commandLineId","commandId","unitPrice","addCommandLinesToTheCart","cmdLines","forEach","getCartCmdLinesFoods","length","Error","getTotalPrice","deleteComandeLine","filter","c","deleteFoodById","id","cardContainAddFoods","factory","providedIn"],"sourceRoot":"","sources":["D:\\PROJETS\\PPP - 2023_2024\\FreshFoodsOnline\\src\\app\\services\\cart.service.ts"],"sourcesContent":["import {Injectable} from '@angular/core';\r\nimport {Observable, of, throwError} from 'rxjs';\r\nimport {CommandLine} from \"../shared/model/command-line\";\r\nimport {Product} from \"../shared/model/Product\";\r\nimport {Food} from \"../shared/model/food\";\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class CartService {\r\n\r\n  private cardFoodsList: Product[] = [];\r\n  private cardCommandLinesList: CommandLine[] = [];\r\n\r\n  constructor() { }\r\n\r\n  public addToCart(prod: Food): void {\r\n    this.cardFoodsList.push(prod);\r\n    /*this.cardFoodsList.forEach(f => {\r\n      this.cardCommandLinesList.forEach(c => {\r\n        const existingCommandLine = this.cardCommandLinesList\r\n          .findIndex(commandLine => commandLine.food.foodId == food.foodId);\r\n        if (existingCommandLine) {\r\n          this.cardCommandLinesList[existingCommandLine].quantity++;\r\n          this.cardCommandLinesList[existingCommandLine].totalCommandLinePrice += food.price;\r\n        } else {\r\n          let commandLine: CommandLine = {\r\n            commandLineId: \"\",\r\n            food: f,\r\n            commandId: \"\",\r\n            unitPrice: f.price,\r\n            quantity: 1,\r\n            totalCommandLinePrice: f.price\r\n          };\r\n          this.cardCommandLinesList.push(commandLine);\r\n        }\r\n      });\r\n      })*/\r\n    // Recherche d'une ligne de commande comportant deja cette Food\r\n    const existingCommandLineIndex = this.cardCommandLinesList\r\n      .findIndex(cmdLine => cmdLine.product.productId === prod.productId);\r\n    if (existingCommandLineIndex != -1){\r\n      this.cardCommandLinesList[existingCommandLineIndex].quantity++;\r\n      this.cardCommandLinesList[existingCommandLineIndex].totalCommandLinePrice += prod.price;\r\n    }else {\r\n      let commandLine: CommandLine = {\r\n        commandLineId: \"\",\r\n        product: prod,\r\n        commandId: \"\",\r\n        unitPrice: prod.price,\r\n        quantity: 1,\r\n        totalCommandLinePrice: prod.price\r\n      };\r\n      this.cardCommandLinesList.push(commandLine);\r\n    }\r\n  }\r\n\r\n  public addCommandLinesToTheCart(cmdLines: Array<CommandLine>): Observable<boolean> {\r\n    cmdLines.forEach(cmdLine => {\r\n      this.cardCommandLinesList.push(cmdLine)\r\n    });\r\n    return of(true);\r\n  }\r\n\r\n  public getCartCmdLinesFoods(): Observable<CommandLine[]> {\r\n    if (this.cardFoodsList.length > 0) {\r\n      return of(this.cardCommandLinesList);\r\n    } else {\r\n      return throwError(() => new Error(\"Food untifined in the cart list.\"));\r\n    }\r\n  }\r\n\r\n  public getTotalPrice(): Observable<number> {\r\n    let price: number = 0;\r\n    this.cardCommandLinesList.forEach(cmdLine => {\r\n      price += cmdLine.totalCommandLinePrice;\r\n    });\r\n    return of(price);\r\n  }\r\n\r\n  public deleteComandeLine(commandLineId: string): Observable<boolean> {\r\n    this.cardCommandLinesList = this.cardCommandLinesList.filter(c => c.commandLineId == commandLineId);\r\n    return of(true);\r\n  }\r\n\r\n  public deleteFoodById(id: number): Observable<boolean> {\r\n    this.cardFoodsList = this.cardFoodsList.filter(prod => prod.productId == id);\r\n    return of(true);\r\n  }\r\n\r\n  public cardContainAddFoods() {\r\n    return this.cardFoodsList.length > 0;\r\n  }\r\n\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}